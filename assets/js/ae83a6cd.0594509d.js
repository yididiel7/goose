"use strict";(self.webpackChunkgoose=self.webpackChunkgoose||[]).push([[8194],{27497:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>p,frontMatter:()=>l,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"tutorials/repomix-mcp","title":"Repomix Extension","description":"Add Repomix MCP Server as a Goose Extension","source":"@site/docs/tutorials/repomix-mcp.md","sourceDirName":"tutorials","slug":"/tutorials/repomix-mcp","permalink":"/goose/docs/tutorials/repomix-mcp","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Repomix Extension","description":"Add Repomix MCP Server as a Goose Extension"},"sidebar":"tutorialSidebar","previous":{"title":"Puppeteer Extension","permalink":"/goose/docs/tutorials/puppeteer-mcp"},"next":{"title":"Selenium Extension","permalink":"/goose/docs/tutorials/selenium-mcp"}}');var o=s(74848),t=s(28453),r=s(65537),c=s(79329);s(25887);const l={title:"Repomix Extension",description:"Add Repomix MCP Server as a Goose Extension"},a=void 0,d={},h=[{value:"Configuration",id:"configuration",level:2},{value:"Example Usage",id:"example-usage",level:2},{value:"Goose Prompt",id:"goose-prompt",level:3},{value:"Goose Output",id:"goose-output",level:3}];function u(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:["This tutorial covers how to add the ",(0,o.jsx)(n.a,{href:"https://github.com/yamadashy/repomix",children:"Repomix MCP Server"})," as a Goose extension to enable automated repository packing, codebase analysis, architecture summaries, test generation, and code exploration, all while compressing the codebase to minimize token usage and stay within your LLM's context limits."]}),"\n",(0,o.jsxs)(n.admonition,{title:"TLDR",type:"tip",children:[(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Command"})}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"npx -y repomix --mcp\n"})})]}),"\n",(0,o.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.p,{children:["Note that you'll need ",(0,o.jsx)(n.a,{href:"https://nodejs.org/",children:"Node.js"})," installed on your system to run this command, as it uses ",(0,o.jsx)(n.code,{children:"npx"}),"."]})}),"\n",(0,o.jsxs)(r.A,{groupId:"interface",children:[(0,o.jsxs)(c.A,{value:"cli",label:"Goose CLI",default:!0,children:[(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["Run the ",(0,o.jsx)(n.code,{children:"configure"})," command:"]}),"\n"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"goose configure\n"})}),(0,o.jsxs)(n.ol,{start:"2",children:["\n",(0,o.jsxs)(n.li,{children:["Choose to add a ",(0,o.jsx)(n.code,{children:"Command-line Extension"})]}),"\n"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"  \u250c   goose-configure \n  \u2502\n  \u25c7  What would you like to configure?\n  \u2502  Add Extension \n  \u2502\n  \u25c6  What type of extension would you like to add?\n  \u2502  \u25cb Built-in Extension \n  // highlight-start    \n  \u2502  \u25cf Command-line Extension (Run a local command or script)\n  // highlight-end    \n  \u2502  \u25cb Remote Extension \n  \u2514 \n"})}),(0,o.jsxs)(n.ol,{start:"3",children:["\n",(0,o.jsx)(n.li,{children:"Give your extension a name"}),"\n"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"  \u250c   goose-configure \n  \u2502\n  \u25c7  What would you like to configure?\n  \u2502  Add Extension \n  \u2502\n  \u25c7  What type of extension would you like to add?\n  \u2502  Command-line Extension \n  \u2502\n  // highlight-start\n  \u25c6  What would you like to call this extension?\n  \u2502  repomix\n  // highlight-end\n  \u2514 \n"})}),(0,o.jsxs)(n.ol,{start:"4",children:["\n",(0,o.jsx)(n.li,{children:"Enter the command"}),"\n"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"  \u250c   goose-configure \n  \u2502\n  \u25c7  What would you like to configure?\n  \u2502  Add Extension \n  \u2502\n  \u25c7  What type of extension would you like to add?\n  \u2502  Command-line Extension \n  \u2502\n  \u25c7  What would you like to call this extension?\n  \u2502  repomix\n  \u2502\n  // highlight-start\n  \u25c6  What command should be run?\n  \u2502  npx -y repomix --mcp\n  // highlight-end\n  \u2514 \n"})}),(0,o.jsxs)(n.ol,{start:"5",children:["\n",(0,o.jsx)(n.li,{children:"Enter the number of seconds Goose should wait for actions to complete before timing out. Default is 300s"}),"\n"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"\u250c   goose-configure \n\u2502\n\u25c7  What would you like to configure?\n\u2502  Add Extension \n\u2502\n\u25c7  What type of extension would you like to add?\n\u2502  Command-line Extension \n\u2502\n\u25c7  What would you like to call this extension?\n\u2502  repomix\n\u2502\n\u25c7  What command should be run?\n\u2502  npx -y repomix --mcp\n\u2502\n// highlight-start\n\u25c6  Please set the timeout for this tool (in secs):\n\u2502  300\n// highlight-end\n\u2502\n\u2514 \n"})}),(0,o.jsxs)(n.ol,{start:"6",children:["\n",(0,o.jsx)(n.li,{children:"Choose No when asked to add environment variables"}),"\n"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:" \u250c   goose-configure \n \u2502\n \u25c7  What would you like to configure?\n \u2502  Add Extension \n \u2502\n \u25c7  What type of extension would you like to add?\n \u2502  Command-line Extension \n \u2502\n \u25c7  What would you like to call this extension?\n \u2502  repomix\n \u2502\n \u25c7  What command should be run?\n \u2502  npx -y repomix --mcp\n \u2502     \n \u25c7  Please set the timeout for this tool (in secs):\n \u2502  300\n \u2502    \n // highlight-start\n \u25c6  Would you like to add environment variables?\n \u2502  No\n \u2502\n // highlight-end\n \u2514  Added repomix extension\n"})})]}),(0,o.jsx)(c.A,{value:"ui",label:"Goose Desktop",children:(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"goose://extension?cmd=npx&arg=-y&arg=repomix&arg=--mcp&id=repomix&name=Repomix&description=Pack%20repositories%20into%20AI-friendly%20formats%20for%20Goose",children:"Launch the installer"})}),"\n",(0,o.jsxs)(n.li,{children:["Press ",(0,o.jsx)(n.code,{children:"Yes"})," to confirm the installation"]}),"\n",(0,o.jsxs)(n.li,{children:["Click ",(0,o.jsx)(n.code,{children:"Save Configuration"})]}),"\n",(0,o.jsxs)(n.li,{children:["Scroll to the top and click ",(0,o.jsx)(n.code,{children:"Exit"})," from the upper left corner"]}),"\n"]})})]}),"\n",(0,o.jsx)(n.h2,{id:"example-usage",children:"Example Usage"}),"\n",(0,o.jsxs)(n.p,{children:["In this example, I\u2019ll show you how to use Goose with the Repomix Extension to analyze the compressed Axios repository. Goose will focus on the ",(0,o.jsx)(n.code,{children:"lib/core/Axios.js"})," file, explain its role in the architecture, spot missing tests, write new unit tests, and suggest improvements to the testing strategy and code maintainability."]}),"\n",(0,o.jsx)(n.p,{children:"By compressing the entire codebase into an AI-friendly format, Repomix helps Goose stay within token limits while providing detailed, file-specific insights."}),"\n",(0,o.jsx)(n.h3,{id:"goose-prompt",children:"Goose Prompt"}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsx)(n.p,{children:"Review the file lib/core/Axios.js from the Axios repository and identify any missing unit tests needed to thoroughly cover its core functions and classes. Explain the role this file plays in the overall Axios architecture, how it integrates with other modules, and how well it is currently tested. Write new unit tests to improve coverage, and recommend improvements to the testing strategy or refactoring opportunities to make the code more maintainable."}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"goose-output",children:"Goose Output"}),"\n",(0,o.jsxs)(n.admonition,{title:"CLI",type:"note",children:[(0,o.jsx)(n.p,{children:"I'll help analyze the Axios.js core file and its testing coverage. Let's break this down into steps:"}),(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"First, let's fetch and examine the Axios repository using repomix"}),"\n",(0,o.jsx)(n.li,{children:"Then analyze the specific file and its related tests"}),"\n",(0,o.jsx)(n.li,{children:"Finally provide recommendations and new unit tests"}),"\n"]}),(0,o.jsx)(n.p,{children:"Let's start by getting the repository:"}),(0,o.jsx)(n.p,{children:"--- Pack Remote Repository ---"}),(0,o.jsx)(n.p,{children:"Now let's read the core Axios.js file and its related test files:"}),(0,o.jsx)(n.p,{children:"--- Read Repomix Output ---"}),(0,o.jsx)(n.p,{children:"Based on my analysis of the Axios codebase, I'll provide you with a comprehensive overview of the project structure and create an improved README. Let me break this down into sections:"}),(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Role in Axios Architecture"})}),(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"Axios.js"})," file is one of the most critical core components of the Axios library. It serves several key purposes:"]}),(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["Request Handling: It contains the main ",(0,o.jsx)(n.code,{children:"Axios"})," class that processes and dispatches HTTP requests"]}),"\n",(0,o.jsx)(n.li,{children:"Configuration Management: Handles merging of default configs with request-specific configs"}),"\n",(0,o.jsx)(n.li,{children:"Interceptor Management: Manages request and response interceptors"}),"\n",(0,o.jsx)(n.li,{children:"HTTP Method Convenience: Provides convenience methods for different HTTP verbs (get, post, etc.)"}),"\n"]}),(0,o.jsx)(n.p,{children:"The file integrates with other core modules through:"}),(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"InterceptorManager"})," for handling request/response interceptors"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"dispatchRequest"})," for making the actual HTTP requests"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"mergeConfig"})," for configuration processing"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"buildFullPath"})," for URL resolution"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"AxiosHeaders"})," for header management"]}),"\n"]}),(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Current Test Coverage Analysis"})}),(0,o.jsx)(n.p,{children:"The current test coverage for Axios.js is fairly good but has some gaps. Looking at the test files:"}),(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"test/unit/core/Axios.js"})," - Focuses mainly on error handling cases, particularly un-writable error stacks"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"test/specs/api.spec.js"})," - Tests the public API surface"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"test/specs/interceptors.spec.js"})," - Tests interceptor functionality"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"test/specs/instance.spec.js"})," - Tests instance creation and configuration"]}),"\n"]}),(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Missing Test Coverage"})}),(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"Error Handling:"}),"\n"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"// Missing tests for error propagation in request chain\n_request(configOrUrl, config) {\n  // Error handling here needs more coverage\n}\n"})}),(0,o.jsxs)(n.ol,{start:"2",children:["\n",(0,o.jsx)(n.li,{children:"Config Processing:"}),"\n"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"// Missing edge cases for config validation\nrequest(configOrUrl, config) {\n  // Config validation edge cases not fully tested\n}\n"})}),(0,o.jsxs)(n.ol,{start:"3",children:["\n",(0,o.jsx)(n.li,{children:"Method Aliases:"}),"\n"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"// Missing tests for all HTTP method aliases with various parameter combinations\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  // Missing tests for these methods with different data types\n});\n"})}),(0,o.jsxs)(n.ol,{start:"4",children:["\n",(0,o.jsx)(n.li,{children:"Interceptor Chain:"}),"\n"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"// Missing tests for complex interceptor chains and error scenarios\nconst chain = [dispatchRequest.bind(this), undefined];\nchain.unshift.apply(chain, requestInterceptorChain);\nchain.push.apply(chain, responseInterceptorChain);\n"})}),(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"New Unit Tests"}),"\nHere are new unit tests to improve coverage:"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"describe('core::Axios', function() {\n  describe('request method', function() {\n    it('should handle null/undefined config values', function(done) {\n      const instance = new Axios({});\n      \n      instance.request({\n        url: '/foo',\n        params: null,\n        data: undefined\n      }).then(function(response) {\n        expect(response.config.params).toBeNull();\n        expect(response.config.data).toBeUndefined();\n        done();\n      }).catch(done);\n    });\n\n    it('should properly merge nested config objects', function(done) {\n      const instance = new Axios({\n        headers: {\n          common: {\n            'X-Common': 'common'\n          },\n          get: {\n            'X-Method': 'get'\n          }\n        }\n      });\n\n      instance.request({\n        method: 'get',\n        headers: {\n          'X-Custom': 'custom'\n        }\n      }).then(function(response) {\n        expect(response.config.headers['X-Common']).toBe('common');\n        expect(response.config.headers['X-Method']).toBe('get');\n        expect(response.config.headers['X-Custom']).toBe('custom');\n        done();\n      }).catch(done);\n    });\n  });\n\n  describe('interceptor chain', function() {\n    it('should handle async interceptors correctly', async function() {\n      const instance = new Axios({});\n      const order = [];\n\n      instance.interceptors.request.use(async function(config) {\n        await new Promise(resolve => setTimeout(resolve, 100));\n        order.push(1);\n        return config;\n      });\n\n      instance.interceptors.request.use(async function(config) {\n        await new Promise(resolve => setTimeout(resolve, 50));\n        order.push(2);\n        return config;\n      });\n\n      instance.interceptors.response.use(async function(response) {\n        await new Promise(resolve => setTimeout(resolve, 100));\n        order.push(3);\n        return response;\n      });\n\n      await instance.request('/foo');\n      expect(order).toEqual([2, 1, 3]); // Interceptors should execute in correct order\n    });\n\n    it('should handle interceptor errors properly', function(done) {\n      const instance = new Axios({});\n      const error = new Error('Interceptor Error');\n\n      instance.interceptors.request.use(function() {\n        throw error;\n      });\n\n      instance.request('/foo').catch(function(e) {\n        expect(e).toBe(error);\n        done();\n      });\n    });\n  });\n\n  describe('HTTP method aliases', function() {\n    it('should handle various data types in post/put/patch', function(done) {\n      const instance = new Axios({});\n      const testCases = [\n        {method: 'post', data: {foo: 'bar'}},\n        {method: 'put', data: 'string data'},\n        {method: 'patch', data: new URLSearchParams('foo=bar')},\n        {method: 'post', data: new FormData()},\n        {method: 'put', data: new Blob(['test'])},\n        {method: 'patch', data: null}\n      ];\n\n      Promise.all(testCases.map(({method, data}) => {\n        return instance[method]('/foo', data).then(response => {\n          expect(response.config.data).toEqual(data);\n          return response;\n        });\n      })).then(() => done()).catch(done);\n    });\n  });\n});\n"})}),(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Recommendations for Testing Strategy"})}),(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"Modular Testing:"}),"\n"]}),(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Break down tests into smaller, focused units"}),"\n",(0,o.jsx)(n.li,{children:"Test each HTTP method alias separately"}),"\n",(0,o.jsx)(n.li,{children:"Create dedicated test suites for config processing, interceptors, and error handling"}),"\n"]}),(0,o.jsxs)(n.ol,{start:"2",children:["\n",(0,o.jsx)(n.li,{children:"Mock Integration Points:"}),"\n"]}),(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Use dependency injection for better isolation"}),"\n",(0,o.jsx)(n.li,{children:"Mock external dependencies consistently"}),"\n",(0,o.jsx)(n.li,{children:"Create reusable mock factories"}),"\n"]}),(0,o.jsxs)(n.ol,{start:"3",children:["\n",(0,o.jsx)(n.li,{children:"Error Handling:"}),"\n"]}),(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Add more tests for error cases"}),"\n",(0,o.jsx)(n.li,{children:"Test error propagation through interceptor chains"}),"\n",(0,o.jsx)(n.li,{children:"Verify error object properties and inheritance"}),"\n"]}),(0,o.jsxs)(n.ol,{start:"4",children:["\n",(0,o.jsx)(n.li,{children:"Config Processing:"}),"\n"]}),(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Test complex config merging scenarios"}),"\n",(0,o.jsx)(n.li,{children:"Verify default values are applied correctly"}),"\n",(0,o.jsx)(n.li,{children:"Test config validation edge cases"}),"\n"]}),(0,o.jsxs)(n.ol,{start:"5",children:["\n",(0,o.jsx)(n.li,{children:"Interceptor Testing:"}),"\n"]}),(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Test complex chains of interceptors"}),"\n",(0,o.jsx)(n.li,{children:"Verify async interceptor behavior"}),"\n",(0,o.jsx)(n.li,{children:"Test interceptor error handling"}),"\n"]}),(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Refactoring Opportunities"})}),(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"Error Handling:"}),"\n"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"// Current\n_request(configOrUrl, config) {\n  try {\n    return this.request(configOrUrl, config);\n  } catch (err) {\n    // Error handling\n  }\n}\n\n// Suggested\nasync _request(configOrUrl, config) {\n  try {\n    return await this.request(configOrUrl, config);\n  } catch (err) {\n    if (err instanceof AxiosError) {\n      throw err;\n    }\n    throw AxiosError.from(err);\n  }\n}\n"})}),(0,o.jsxs)(n.ol,{start:"2",children:["\n",(0,o.jsx)(n.li,{children:"Config Processing:"}),"\n"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"// Current\nrequest(configOrUrl, config) {\n  // Config processing\n}\n\n// Suggested\nrequest(configOrUrl, config) {\n  const normalizedConfig = this._normalizeConfig(configOrUrl, config);\n  this._validateConfig(normalizedConfig);\n  return this._processRequest(normalizedConfig);\n}\n"})}),(0,o.jsxs)(n.ol,{start:"3",children:["\n",(0,o.jsx)(n.li,{children:"Interceptor Chain:"}),"\n"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"// Current\n// Interceptor chain building mixed with request logic\n\n// Suggested\nclass InterceptorChain {\n  constructor(request, config) {\n    this.request = request;\n    this.config = config;\n    this.chain = [];\n  }\n\n  addRequestInterceptors(interceptors) {\n    // Add request interceptors\n  }\n\n  addResponseInterceptors(interceptors) {\n    // Add response interceptors\n  }\n\n  execute() {\n    // Execute chain\n  }\n}\n"})}),(0,o.jsx)(n.p,{children:"These improvements would make the code more maintainable and easier to test, while also improving error handling and separation of concerns."}),(0,o.jsx)(n.p,{children:"The current test coverage is good but could be improved in these specific areas to ensure more robust functionality. The suggested new tests and refactoring opportunities would help catch edge cases and make the code more maintainable."})]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(u,{...e})}):u(e)}},25887:(e,n,s)=>{s.d(n,{A:()=>t});s(96540);var i=s(52362),o=s(74848);const t=e=>{let{videoUrl:n}=e;return(0,o.jsxs)("div",{children:[(0,o.jsx)(i.A,{type:"info",icon:"\ud83c\udfa5",title:"Plug & Play",className:"alert--video",children:(0,o.jsxs)("details",{children:[(0,o.jsx)("summary",{children:"Watch the demo"}),(0,o.jsx)("div",{style:{textAlign:"center",margin:"20px 0"},children:(0,o.jsx)("iframe",{width:"100%",height:"540",src:n,title:"YouTube Short",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})]})}),(0,o.jsx)("hr",{})]})}}}]);